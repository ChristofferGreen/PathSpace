<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PathSpace: PathSpace — Carta Linea Plan</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PathSpace
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__2_users_2chrgre01_2src_2_path_space_2docs_2_a_i___plan___carta_linea.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">PathSpace — Carta Linea Plan </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md61"></a></p>
<p>Status: Active concept (MVP-focused) Scope: Cross-app model for cards, timeline, and filesystem projections backed by paths Audience: Product/UX, system architects, UI/rendering engineers</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md62"></a>
Overview</h1>
<p>Carta Linea unifies three views of the same object space and introduces a deck model where an application is a deck of its active cards (e.g., Photoshop as a deck of open documents) and users can also define explicit decks:</p><ul>
<li>Card View (task-oriented): what’s active, pinned, or snoozed now.</li>
<li>Lifestream View (time-oriented): past, present, and scheduled future across all objects.</li>
<li>Filesystem View (structure-oriented): the canonical folders-and-files hierarchy.</li>
</ul>
<p>Every object has a canonical filesystem path for its content and a small amount of metadata (timestamps, lifecycle, tags, and optional relations). The three views are projections over the same objects; there is no duplication of content. See Foundations for how PathSpace (storage) and SceneGraph (UI) underpin the model.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md63"></a>
Goals</h1>
<ul>
<li>One object, many views: cards and timeline derive from the same canonical path and metadata.</li>
<li>Filesystem-first: content lives where it is; all features are additive and non-disruptive.</li>
<li>Path-based integration: index and control surfaces exposed as paths (readable, scriptable).</li>
<li>Atomicity: publish changes via atomic writes/renames; readers observe consistent snapshots.</li>
<li>Incremental adoption: useful with zero app integration; apps can opt into richer hints over time.</li>
</ul>
<p>Non-goals (MVP):</p><ul>
<li>Multi-device sync and conflict resolution.</li>
<li>Encrypted metadata and access controls.</li>
<li>Full-text content indexing.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md64"></a>
Core model (MVP)</h1>
<p>Object (conceptual record):</p><ul>
<li>id: stable UUID (per object).</li>
<li>kind: one of { file, directory, task } (extendable later).</li>
<li>path: canonical path (for file/directory kinds); tasks may reside under a virtual root.</li>
<li>timestamps:<ul>
<li>created_at, updated_at (derived from filesystem or sidecar)</li>
<li>active_from (when the object became active)</li>
<li>due_at (optional)</li>
<li>completed_at (optional)</li>
</ul>
</li>
<li>lifecycle: one of { inactive, active, pinned, snoozed, completed, dismissed }</li>
<li>tags: optional list of labels (hierarchical tags allowed, e.g., project/alpha).</li>
<li>app_id: optional application affinity (e.g., com.vendor.app or internal id) used to build application decks</li>
<li>stack_id: optional grouping key to render related cards as a stack.</li>
</ul>
<p>Notes:</p><ul>
<li>The canonical path is authoritative for content. For virtual objects (e.g., tasks), a synthetic path under a virtual root is used.</li>
<li>The metadata surface is minimal by design to stay compatible with existing workflows.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md65"></a>
Foundations: PathSpace storage and SceneGraph UI</h1>
<p>PathSpace provides the storage substrate and path-based API used by Carta Linea. Storing indices and operations as paths makes the model scriptable, testable, and safe for multithreaded producers/consumers via write-then-rename semantics used across the project. Because storage is path-addressable, replication across processes or machines can be provided by underlying PathSpace mechanisms without changing Carta Linea’s data model or APIs.</p>
<p>Cards, Lifestream, and Filesystem are presented using the SceneGraph and Renderer. A card is a SceneGraph application/scene bound to an object id (or a stack) and reading from <span class="tt">index/builds/&lt;revision&gt;/*</span> selected via <span class="tt">index/current_revision</span>; the exact equivalence of “task” and “application” is intentionally flexible and may vary per app.</p>
<p>See <a class="el" href="_a_i___a_r_c_h_i_t_e_c_t_u_r_e_8md.html">docs/AI_Architecture.md</a> and <a class="el" href="_a_i___plan___scene_graph___renderer_8md.html">docs/Plan_SceneGraph_Renderer.md</a> for details. Scenes operate on app-relative paths inside the Carta app root and consume derived assets published under <span class="tt">index/builds/&lt;revision&gt;/...</span> via <span class="tt">index/current_revision</span>; they should not traverse arbitrary OS paths during rendering.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md66"></a>
Card forms: typed vs freeform (SceneGraph subtrees)</h1>
<ul>
<li>A card’s visual and interactive structure is a sub-SceneGraph (“form”) bound to an object id.</li>
<li>Forms come in two modes:<ul>
<li>Freeform: a generic card usable for any object; shows title/path, preview (if available), and basic actions.</li>
<li>Typed: specific shapes for well-known kinds or content types (e.g., email, tweet, image/jpeg).</li>
</ul>
</li>
</ul>
<p>Selection (MVP — highest priority first): 1) Object override:</p><ul>
<li><span class="tt">/users/&lt;user&gt;/system/applications/carta/index/objects/&lt;id&gt;/form</span> contains an app-relative scene path (e.g., <span class="tt">scenes/card_forms/image</span>). If present, use it. 2) Content type:</li>
<li>If a MIME-type hint exists (sidecar or sniff), resolve via <span class="tt">index/forms/selectors/by_mime/&lt;mime&gt;</span> → <span class="tt">&lt;form-id&gt;</span>. 3) Kind default:</li>
<li>Resolve via <span class="tt">index/forms/selectors/by_kind/&lt;kind&gt;</span> → <span class="tt">&lt;form-id&gt;</span>. 4) Fallback:</li>
<li>Use <span class="tt">freeform</span>.</li>
</ul>
<p>Path layout (under Carta app root):</p><ul>
<li><span class="tt">scenes/card_forms/&lt;form-id&gt;/</span><ul>
<li><span class="tt">src/...</span>, <span class="tt">builds/&lt;revision&gt;/...</span>, <span class="tt">current_revision</span> (see <a class="el" href="_a_i___p_a_t_h_s_8md.html">docs/AI_Paths.md</a>)</li>
</ul>
</li>
<li><span class="tt">index/forms/selectors/</span><ul>
<li><span class="tt">by_mime/&lt;mime&gt;</span> — text file containing app-relative path, e.g. <span class="tt">scenes/card_forms/image</span></li>
<li><span class="tt">by_kind/&lt;kind&gt;</span> — text file containing app-relative path, e.g. <span class="tt">scenes/card_forms/task</span></li>
</ul>
</li>
<li><span class="tt">index/objects/&lt;id&gt;/form</span> — optional per-object override (app-relative scene path)</li>
</ul>
<p>SceneGraph contract (v1):</p><ul>
<li>Inputs: object id; card scene reads <span class="tt">index/builds/&lt;revision&gt;/objects/&lt;id&gt;/*</span> and uses derived assets under <span class="tt">index/builds/&lt;revision&gt;/objects/&lt;id&gt;/derived/*</span>. Scenes must read only app-relative paths under the Carta app root and must not open arbitrary filesystem paths at render time.</li>
<li>Standard slots: header, body, footer. Typed forms fill these consistently; freeform fills minimally.</li>
<li>Output: drawable subtree authored under the form’s scene; rendering/publishing follows the snapshot rules in <a class="el" href="_a_i___plan___scene_graph___renderer_8md.html">docs/Plan_SceneGraph_Renderer.md</a>.</li>
</ul>
<p>Examples (non-normative):</p><ul>
<li>email: header(from, subject, time), body preview, actions (reply/archive).</li>
<li>tweet: author, handle, text, media thumbnails, action badges.</li>
<li>image/jpeg: image fit-to-card, metadata strip, open action.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md67"></a>
Decks (applications and explicit)</h1>
<p>Concept:</p><ul>
<li>A deck is an ordered container of cards.</li>
<li>Application deck: a runtime/application-defined deck (e.g., “Photoshop” deck contains all open document cards).</li>
<li>Explicit deck: a user-defined deck (e.g., “Today”, “Reading”, “Sprint 42”).</li>
</ul>
<p>Path layout (under Carta app root):</p><ul>
<li><span class="tt">index/decks/&lt;deck-id&gt;/</span><ul>
<li><span class="tt">meta/type</span> — <span class="tt">application</span> or <span class="tt">explicit</span></li>
<li><span class="tt">meta/title</span> — human-readable title</li>
</ul>
</li>
<li><span class="tt">index/builds/&lt;revision&gt;/decks/&lt;deck-id&gt;/</span><ul>
<li><span class="tt">cards/&lt;order&gt;-&lt;object-id&gt;</span> — zero-padded order entries (explicit decks only)</li>
</ul>
</li>
<li>Membership hints:<ul>
<li><span class="tt">index/objects/&lt;id&gt;/deck/&lt;deck-id&gt;</span> — presence indicates membership (for explicit decks)</li>
</ul>
</li>
<li>Application decks (derived):<ul>
<li><span class="tt">index/builds/&lt;revision&gt;/decks/app/&lt;app-id&gt;/</span><ul>
<li><span class="tt">cards/&lt;rev_epoch_ms&gt;-&lt;object-id&gt;</span> — derived recency order (newer first; apps may later supply explicit order)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Operations (MVP):</p><ul>
<li>Add to explicit deck:<ul>
<li>Drop file to <span class="tt">ops/deck_add/inbox/</span> with body: <span class="tt">&lt;deck-id&gt; &lt;object-id&gt;\n</span></li>
</ul>
</li>
<li>Remove from explicit deck:<ul>
<li>Drop file to <span class="tt">ops/deck_remove/inbox/</span> with body: <span class="tt">&lt;deck-id&gt; &lt;object-id&gt;\n</span></li>
</ul>
</li>
<li>Reorder within an explicit deck:<ul>
<li>Drop file to <span class="tt">ops/deck_move/inbox/</span> with body: <span class="tt">&lt;deck-id&gt; &lt;object-id&gt; &lt;new_zero_padded_order&gt;\n</span></li>
</ul>
</li>
</ul>
<p>SceneGraph contract:</p><ul>
<li><span class="tt">scenes/deck</span> renders a deck by reading <span class="tt">index/builds/&lt;revision&gt;/decks/&lt;deck-id&gt;/cards/*</span> selected via <span class="tt">index/current_revision</span> and composes child card forms (by id) using the selection rules above.</li>
<li>An application’s primary view can be a deck scene; e.g., a Twitter deck rendering tweet cards, or a Photoshop deck rendering document cards.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md68"></a>
Path layout</h1>
<p>System-owned and user-owned application roots (see <a class="el" href="_a_i___p_a_t_h_s_8md.html">docs/AI_Paths.md</a>):</p><ul>
<li><span class="tt">/system/applications/&lt;app&gt;</span></li>
<li><span class="tt">/users/&lt;user&gt;/system/applications/&lt;app&gt;</span></li>
</ul>
<p>Carta Linea uses a user-owned application root:</p><ul>
<li><span class="tt">/users/&lt;user&gt;/system/applications/carta/</span></li>
</ul>
<p>Within this root (MVP):</p><ul>
<li><span class="tt">index/</span> — snapshot builds of read models for the projections<ul>
<li><span class="tt">builds/&lt;revision&gt;/</span><ul>
<li><span class="tt">objects/&lt;id&gt;/path</span> — canonical path to content (text)</li>
<li><span class="tt">objects/&lt;id&gt;/kind</span> — kind (text)</li>
<li><span class="tt">objects/&lt;id&gt;/lifecycle</span> — lifecycle (text)</li>
<li><span class="tt">objects/&lt;id&gt;/app_id</span> — application affinity (text), used to populate application decks</li>
<li><span class="tt">objects/&lt;id&gt;/timestamps/{created_at,updated_at,active_from,due_at,completed_at}</span> (text ISO-8601; files optional if unset)</li>
<li><span class="tt">objects/&lt;id&gt;/derived/thumbnail</span> — renderer-friendly preview asset (immutable snapshot)</li>
<li><span class="tt">objects/&lt;id&gt;/derived/text_preview</span> — small text extract when applicable</li>
<li><span class="tt">objects/&lt;id&gt;/derived/meta</span> — normalized metadata blob for forms</li>
<li><span class="tt">cards/active/&lt;rev_epoch_ms&gt;-&lt;id&gt;</span> — presence indicates active; recency key is (9999999999999 - epoch_ms) to sort newest first lexicographically</li>
<li><span class="tt">cards/pinned/&lt;order&gt;-&lt;id&gt;</span> — zero-padded order index; lower sorts earlier (explicit pin order)</li>
<li><span class="tt">cards/snoozed/&lt;wake&gt;-&lt;id&gt;</span> — wake time key (e.g., <span class="tt">2025-09-30T09:00:00Z</span>)</li>
<li><span class="tt">stream/&lt;YYYY&gt;/&lt;MM&gt;/&lt;DD&gt;/&lt;time&gt;-&lt;id&gt;</span> — timeline key files for that day (time-ordered)</li>
<li><span class="tt">tags/&lt;tag-path&gt;/&lt;id&gt;</span> — membership in a tag (e.g., <span class="tt">tags/project/alpha/&lt;id&gt;</span>)</li>
</ul>
</li>
<li><span class="tt">current_revision</span> — single-value pointer to latest published index build</li>
</ul>
</li>
<li>Per-object derived snapshots (optional producer contract):<ul>
<li><span class="tt">index/objects/&lt;id&gt;/derived/builds/&lt;revision&gt;/...</span></li>
<li><span class="tt">index/objects/&lt;id&gt;/derived/current_revision</span></li>
</ul>
</li>
<li><span class="tt">ops/</span> — execution queues (append via file-drop into inbox directories)<ul>
<li><span class="tt">activate/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt;\n</span></li>
<li><span class="tt">complete/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt;\n</span></li>
<li><span class="tt">dismiss/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt;\n</span></li>
<li><span class="tt">pin/inbox/</span> / <span class="tt">unpin/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt;\n</span></li>
<li><span class="tt">snooze/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt; &lt;iso8601&gt;\n</span></li>
<li><span class="tt">stack/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt; &lt;stack_id&gt;\n</span></li>
<li><span class="tt">unstack/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt;\n</span></li>
<li><span class="tt">tag_add/inbox/</span> / <span class="tt">tag_remove/inbox/</span> — create a file with body: <span class="tt">&lt;id&gt; &lt;tag&gt;\n</span></li>
</ul>
</li>
<li><span class="tt">log/</span> — newline-delimited operational log (append-only for audit/troubleshooting)<ul>
<li><span class="tt">events</span> — human-readable summaries of operations applied</li>
<li><span class="tt">errors</span> — errors/warnings emitted by the indexer</li>
</ul>
</li>
</ul>
<p>Sidecars at the content location (optional but recommended):</p><ul>
<li><span class="tt">.carta/id</span> — object UUID (text)</li>
<li><span class="tt">.carta/meta.json</span> — optional author hints (display title, preferred icon, stable tags)</li>
</ul>
<p>Virtual root for task-like objects (if used):</p><ul>
<li><span class="tt">/users/&lt;user&gt;/system/applications/carta/virtual/tasks/&lt;id&gt;/</span> — placeholder path for tasks</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md69"></a>
Indexer responsibilities (MVP)</h1>
<p>A single user-space indexer process maintains the <span class="tt">index/</span> subtree:</p><ul>
<li>Discover objects:<ul>
<li>For files/directories: within user-selected roots (config TBD), mint or read <span class="tt">.carta/id</span>.</li>
<li>For tasks: under the virtual root, the id is the directory name.</li>
</ul>
</li>
<li>Maintain object records:<ul>
<li>Track canonical <span class="tt">path</span>, <span class="tt">kind</span>, <span class="tt">timestamps</span> (fs stat + sidecar overrides).</li>
<li>Update <span class="tt">lifecycle</span> per operations or inferred activity (e.g., activate on open if bound).</li>
</ul>
</li>
<li>Maintain projections (materialized files):<ul>
<li>Cards: update <span class="tt">cards/active</span>, <span class="tt">cards/pinned</span>, <span class="tt">cards/snoozed</span> using atomic file creates/removes and ordered names.</li>
<li>Lifestream: create timeline entries under <span class="tt">stream/YYYY/MM/DD/...</span> keyed by a primary time (see Timeline policy).</li>
<li>Tags: maintain presence under <span class="tt">tags/&lt;tag-path&gt;/&lt;id&gt;</span>.</li>
</ul>
</li>
<li>Atomicity:<ul>
<li>Write to a temporary file and rename into place.</li>
<li>Update fan-out structures in a consistent order; on crash, re-scan to reconcile.</li>
</ul>
</li>
<li>Observability:<ul>
<li>Append a concise line to <span class="tt">log/events</span> per applied operation.</li>
<li>Write errors to <span class="tt">log/errors</span>.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md70"></a>
Timeline policy (MVP)</h1>
<p>Primary time key for ordering an object in the Lifestream: 1) <span class="tt">completed_at</span> if set 2) else <span class="tt">active_from</span> if set 3) else <span class="tt">updated_at</span> 4) else <span class="tt">created_at</span></p>
<p>The key selection is stable per object update and recorded under the current index build (e.g., <span class="tt">index/builds/&lt;revision&gt;/objects/&lt;id&gt;/timeline_key</span>, selected via <span class="tt">index/current_revision</span>).</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md71"></a>
Operations (user-visible semantics)</h1>
<p>All operations are path-driven via <span class="tt">ops/&lt;op&gt;/inbox/</span> queues. Each file dropped into an inbox is applied once by the indexer; invalid payloads are logged to <span class="tt">log/errors</span>.</p>
<ul>
<li>Activate: drop a file into <span class="tt">ops/activate/inbox/</span> with body <span class="tt">&lt;id&gt;\n</span><ul>
<li>Sets <span class="tt">lifecycle=active</span>, <span class="tt">active_from=now</span>, updates cards and stream.</li>
</ul>
</li>
<li>Complete: drop a file into <span class="tt">ops/complete/inbox/</span> with body <span class="tt">&lt;id&gt;\n</span><ul>
<li>Sets <span class="tt">lifecycle=completed</span>, <span class="tt">completed_at=now</span>, updates stream, removes from active.</li>
</ul>
</li>
<li>Dismiss: drop a file into <span class="tt">ops/dismiss/inbox/</span> with body <span class="tt">&lt;id&gt;\n</span><ul>
<li>Sets <span class="tt">lifecycle=dismissed</span>, removes from active; remains visible in stream.</li>
</ul>
</li>
<li>Pin/Unpin: drop a file into <span class="tt">ops/pin/inbox/</span> or <span class="tt">ops/unpin/inbox/</span> with body <span class="tt">&lt;id&gt;\n</span><ul>
<li>Adds/removes from <span class="tt">cards/pinned</span> with a rank; rank policy: new pins get topmost rank.</li>
</ul>
</li>
<li>Snooze: drop a file into <span class="tt">ops/snooze/inbox/</span> with body <span class="tt">&lt;id&gt; &lt;iso8601&gt;\n</span><ul>
<li>Sets <span class="tt">lifecycle=snoozed</span>, hides from active until wake; presence under <span class="tt">cards/snoozed/&lt;wake&gt;-&lt;id&gt;</span>.</li>
</ul>
</li>
<li>Stack/Unstack: drop a file into <span class="tt">ops/stack/inbox/</span> with body <span class="tt">&lt;id&gt; &lt;stack_id&gt;\n</span> or into <span class="tt">ops/unstack/inbox/</span> with body <span class="tt">&lt;id&gt;\n</span><ul>
<li>Sets/clears <span class="tt">stack_id</span>; cards render as grouped.</li>
</ul>
</li>
<li>Tag add/remove: drop a file into <span class="tt">ops/tag_add/inbox/</span> or <span class="tt">ops/tag_remove/inbox/</span> with body <span class="tt">&lt;id&gt; &lt;tag&gt;\n</span><ul>
<li>Adds/removes membership under <span class="tt">tags/&lt;tag&gt;/&lt;id&gt;</span>.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md72"></a>
Integration</h1>
<p>Zero-integration:</p><ul>
<li>Files and folders are indexed from the filesystem alone.</li>
<li>Users can activate, pin, snooze, tag, and complete without app changes.</li>
</ul>
<p>Optional sidecar hints:</p><ul>
<li>Apps can write <span class="tt">.carta/meta.json</span> with stable tags or display hints.</li>
<li>If desired, apps can manage <span class="tt">.carta/id</span> on copy/duplicate workflows.</li>
</ul>
<p>UI surfaces (built within the existing rendering system; see <a class="el" href="_a_i___plan___scene_graph___renderer_8md.html">docs/Plan_SceneGraph_Renderer.md</a>):</p><ul>
<li><span class="tt">scenes/cards</span> — renders <span class="tt">index/builds/&lt;revision&gt;/cards/*</span> selected via <span class="tt">index/current_revision</span> with stacking and pin order.</li>
<li><span class="tt">scenes/deck</span> — renders <span class="tt">index/builds/&lt;revision&gt;/decks/&lt;deck-id&gt;/cards/*</span> selected via <span class="tt">index/current_revision</span> as a deck (application or explicit) and composes child card forms.</li>
<li><span class="tt">scenes/lifestream</span> — renders <span class="tt">index/builds/&lt;revision&gt;/stream/*</span> selected via <span class="tt">index/current_revision</span> with date buckets.</li>
<li><span class="tt">scenes/files</span> — renders the canonical filesystem view with Carta badges. Example wiring (abridged):</li>
<li><span class="tt">renderers/2d/targets/surfaces/cards/scene = "scenes/cards"</span></li>
<li><span class="tt">surfaces/cards/renderer = "renderers/2d"</span></li>
<li><span class="tt">surfaces/cards/scene = "scenes/cards"</span></li>
<li><span class="tt">windows/MainWindow/views/cards/surface = "surfaces/cards"</span></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md73"></a>
Atomicity and concurrency</h1>
<ul>
<li>All <span class="tt">index/</span> updates use write-then-rename; readers see consistent states.</li>
<li><span class="tt">ops/*</span> files are treated as append-only queues; the indexer consumes lines idempotently.</li>
<li>On startup, the indexer reconciles <span class="tt">index/</span> against discovered content and sidecars.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md74"></a>
Failure modes</h1>
<ul>
<li>Missing <span class="tt">.carta/id</span>: mint a new id and write sidecar; log the event.</li>
<li>Duplicate ids (e.g., copied folder): detect when two paths claim the same id; mint a new id for the copy and fix the sidecar; log remediation.</li>
<li>Moved/renamed content: track by id; update path in the next index build so readers see it under <span class="tt">index/builds/&lt;revision&gt;/objects/&lt;id&gt;/path</span>.</li>
<li>Stale index entries: periodic reconciliation removes entries for missing content.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md75"></a>
MVP</h1>
<ul>
<li>Kinds: file, directory, task (virtual).</li>
<li>Lifecycle: inactive, active, pinned, snoozed, completed, dismissed.</li>
<li>Minimal metadata: id, kind, path, timestamps, lifecycle, tags, stack_id.</li>
<li>Paths:<ul>
<li>User app root: <span class="tt">/users/&lt;user&gt;/system/applications/carta/</span></li>
<li><span class="tt">index/builds/&lt;revision&gt;/...</span> with <span class="tt">index/current_revision</span> (readers)</li>
<li><span class="tt">ops/*</span>, <span class="tt">log/*</span></li>
<li>Sidecars: <span class="tt">.carta/id</span>, optional <span class="tt">.carta/meta.json</span></li>
</ul>
</li>
<li>Projections:<ul>
<li>Cards: pinned, then active by recency; snoozed hidden until wake.</li>
<li>Lifestream: Today, Yesterday, This Week, Earlier, and Upcoming.</li>
<li>Filesystem: unmodified structure with Carta badges.</li>
</ul>
</li>
<li>Performance targets:<ul>
<li>Operation to visible update: &lt; 250 ms end-to-end.</li>
<li>UI readers perform read-only path traversal; no locks required.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md76"></a>
Open questions</h1>
<ul>
<li>What scope of the filesystem is indexed by default (per-user roots, explicit opt-in, or both)?</li>
<li>Should tasks always be virtual under Carta’s root, or optionally materialized as files?</li>
<li>Rank policy for pinned items (explicit numeric vs. implicit recency) — pick one for MVP and keep files stable.</li>
<li>Minimum set of tags supported in UI (free-form vs. curated namespaces).</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md77"></a>
Cross-references</h1>
<ul>
<li>See <a class="el" href="_a_i___p_a_t_h_s_8md.html">docs/AI_Paths.md</a> for canonical path conventions and app roots.</li>
<li>See <a class="el" href="_a_i___plan___scene_graph___renderer_8md.html">docs/Plan_SceneGraph_Renderer.md</a> for scene/surface organization; Carta views should adopt the same atomic publication and snapshot patterns. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
