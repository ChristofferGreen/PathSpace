<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PathSpace: PathSpace</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PathSpace
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">PathSpace </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2_users_2chrgre01_2src_2_path_space_2_r_e_a_d_m_e"></a></p>
<p>Typed, hierarchical, thread-safe paths for data and computations.</p>
<p>PathSpace is a C++ library inspired by tuplespaces (e.g., Linda) and reactive/dataflow ideas. You insert values or executions at paths, then read or take them—optionally blocking with timeouts. Paths look like a filesystem, and inserts can target multiple nodes using simple glob patterns.</p>
<ul>
<li>Typed values (fundamental types, std::string, and most STL containers/structs via Alpaca serialization)</li>
<li>Executions (lambdas, std::function, function pointers) with Lazy or Immediate scheduling</li>
<li>Blocking reads with timeouts and non-blocking peeks</li>
<li>Globbed insert to fan-out to multiple existing subtrees</li>
<li>Thread-safe from the ground up</li>
</ul>
<p>Links:</p><ul>
<li>docs/AI_Architecture.md (design and internals)</li>
<li>docs/AI_Paths.md (canonical namespace/layout conventions)</li>
<li>docs/Plan_Overview.md (index of active plan documents and priorities)</li>
<li>docs/Plan_Distributed_PathSpace.md (distributed mounting/network plan)</li>
<li>docs/Plan_PathSpace_Inspector.md (live PathSpace inspector roadmap)</li>
<li>examples/devices_example.cpp (experimental device IO example)</li>
<li>examples/paint_example.cpp (minimal software paint demo; currently macOS-only)</li>
<li>build/docs/html/index.html (Doxygen API Reference)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Architecture at a Glance</h1>
<ul>
<li><b>Trie-backed space</b> — <span class="tt">PathSpace</span> stores data in a concurrent trie of <span class="tt">Node</span> objects. Each node owns serialized <span class="tt">NodeData</span> payloads plus queued <span class="tt">Task</span> executions; inserts append, reads copy, and takes pop without global locks. See “Internal Data” in <span class="tt">docs/AI_Architecture.md</span>.</li>
<li><b>Paths &amp; globbing</b> — Strongly-typed <span class="tt">ConcretePath</span>/<span class="tt">GlobPath</span> wrappers provide component iterators, pattern matching (<span class="tt">*</span>, <span class="tt">**</span>, ranges), and validation (<span class="tt">src/pathspace/path/</span>).</li>
<li><b>Wait/notify</b> — Blocking reads register waiters in concrete/glob registries and wake via a <span class="tt">NotificationSink</span> token; timeouts surface as <span class="tt">Error::Timeout</span> (<span class="tt">Wait/notify</span> + <span class="tt">Blocking</span> in the architecture doc).</li>
<li><b>Layers &amp; PathIO</b> — Permission-checked views (<span class="tt">PathView</span>), alias mounts (<span class="tt">PathAlias</span>), and OS/event bridges live in <span class="tt">src/pathspace/layer/</span>. Enable macOS backends with <span class="tt">-DENABLE_PATHIO_MACOS=ON</span> and review the PathIO guidance near the end of <span class="tt">docs/AI_Architecture.md</span>.</li>
<li><b>Canonical namespaces</b> — <span class="tt">docs/AI_Paths.md</span> defines system/app/render targets; renderer and presenter plans live in <span class="tt">docs/Plan_SceneGraph_Renderer.md</span>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
Quick start</h1>
<p>1) Prerequisites</p><ul>
<li>A C++23 compiler (Clang or GCC)</li>
<li>CMake ≥ 3.15</li>
<li>macOS/Linux/Windows</li>
</ul>
<p>2) Configure &amp; build </p><div class="fragment"><div class="line">git clone &lt;this-repo&gt;</div>
<div class="line">cd PathSpace</div>
<div class="line">cmake -S . -B build -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">cmake --build build -j</div>
</div><!-- fragment --><p>3) Run tests (recommended) </p><div class="fragment"><div class="line">ctest --test-dir build --output-on-failure -j --repeat-until-fail 15 --timeout 20</div>
</div><!-- fragment --><p> or use the helper that wraps the loop/timeout policy from <span class="tt">docs/AI_Architecture.md</span>: </p><div class="fragment"><div class="line">./scripts/compile.sh --loop=15 --timeout=20</div>
</div><!-- fragment --><p>4) Use in your project</p><ul>
<li>Link against the <span class="tt">PathSpace</span> target (installed or via add_subdirectory)</li>
<li>Include headers from <span class="tt">src/pathspace</span>: <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="ttc" id="a_path_space_8hpp_html"><div class="ttname"><a href="_path_space_8hpp.html">PathSpace.hpp</a></div></div>
</div><!-- fragment --></li>
</ul>
<p>Build options:</p><ul>
<li>ENABLE_ADDRESS_SANITIZER=ON|OFF</li>
<li>ENABLE_THREAD_SANITIZER=ON|OFF</li>
<li>ENABLE_UNDEFINED_SANITIZER=ON|OFF</li>
<li>ENABLE_PATHIO_MACOS=ON|OFF (compile-time defines for experimental macOS PathIO)</li>
<li>BUILD_PATHSPACE_EXAMPLES=ON|OFF</li>
</ul>
<p>Tip: Enable sanitizers when debugging concurrency/path issues, and pair <span class="tt">ENABLE_PATHIO_MACOS=ON</span> with the PathIO section in <span class="tt">docs/AI_Architecture.md</span> if you need native device backends.</p>
<p>Scripts:</p><ul>
<li>./scripts/compile.sh</li>
<li>./scripts/update_compile_commands.sh (keeps compile_commands.json in repo root)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Documentation (Doxygen)</h1>
<p>You can generate HTML API documentation into build/docs/html:</p>
<ul>
<li>Using the helper script (requires doxygen): <div class="fragment"><div class="line">./scripts/compile.sh --docs</div>
</div><!-- fragment --> Output: <a href="build/docs/html/index.html">build/docs/html/index.html</a></li>
<li>Using CMake directly: <div class="fragment"><div class="line">cmake -S . -B build -DENABLE_DOXYGEN=ON</div>
<div class="line">cmake --build build --target docs -j</div>
</div><!-- fragment --> Output: <a href="build/docs/html/index.html">build/docs/html/index.html</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
API at a glance</h1>
<p>All operations below are member functions on a PathSpace instance. Assume <span class="tt">PathSpace ps;</span>.</p>
<ul>
<li>Insert a typed value or execution:<ul>
<li><span class="tt">ps.insert&lt;"/a/b"&gt;(42)</span></li>
<li><span class="tt">ps.insert&lt;"/a/f"&gt;([](){ return 123; })</span></li>
<li><span class="tt">ps.insert&lt;"/a/f"&gt;([](){ return 123; })</span> with compile-time path validation</li>
</ul>
</li>
<li>Read (copy, non-destructive) or take (destructive):<ul>
<li><span class="tt">auto v = ps.read&lt;int&gt;("/a/b");</span></li>
<li><span class="tt">auto v = ps.take&lt;int&gt;("/a/b", Block{500ms});</span></li>
</ul>
</li>
<li>Blocking and timeouts:<ul>
<li><span class="tt">ps.read&lt;T&gt;(path, Block{timeout})</span> blocks until available or times out</li>
</ul>
</li>
<li>Execution scheduling category:<ul>
<li>Lazy (run on first read) or Immediate (run when inserted)</li>
<li><span class="tt">ps.insert&lt;"/exec"&gt;(fn, Lazy{})</span> or <span class="tt">ps.insert&lt;"/exec"&gt;(fn, Immediate{})</span></li>
</ul>
</li>
<li>Peek a future (execution result handle) via the unified read API:<ul>
<li><span class="tt">auto fut = ps.read&lt;FutureAny&gt;("/exec");</span> returns a type-erased FutureAny</li>
</ul>
</li>
<li>Globbed insert (fan-out to existing subtrees):<ul>
<li><span class="tt">ps.insert&lt;"/sensors/*/status"&gt;(1)</span> writes to all matching, already-existing paths</li>
</ul>
</li>
</ul>
<p>Notes:</p><ul>
<li>Read/take expect concrete (non-glob) paths.</li>
<li>Insert supports glob patterns to target multiple existing matches.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Simple examples</h1>
<p>Hello, PathSpace: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Insert then read</span></div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/numbers/answer&quot;</span>&gt;(42);</div>
<div class="line">    <span class="keyword">auto</span> v = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/numbers/answer&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (v) {</div>
<div class="line">        <span class="comment">// 42</span></div>
<div class="line">        (void)v.value();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Take removes the value</span></div>
<div class="line">    <span class="keyword">auto</span> first = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a9d6d6181387a09664b3608813c29f51a">take</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/numbers/answer&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> none  = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/numbers/answer&quot;</span>); <span class="comment">// no value now</span></div>
<div class="line">}</div>
<div class="ttc" id="aclass_s_p_1_1_path_space_base_html_a2941f2763aad2813c12a9a886ccf5961"><div class="ttname"><a href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">SP::PathSpaceBase::read</a></div><div class="ttdeci">auto read(S const &amp;pathIn, Out const &amp;options={}) const -&gt; Expected&lt; DataType &gt;</div><div class="ttdef"><b>Definition</b> PathSpaceBase.hpp:86</div></div>
<div class="ttc" id="aclass_s_p_1_1_path_space_base_html_a7f160bb41b90202c97f3581612e22001"><div class="ttname"><a href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">SP::PathSpaceBase::insert</a></div><div class="ttdeci">auto insert(S const &amp;pathIn, DataType &amp;&amp;data, In const &amp;options={}) -&gt; InsertReturn</div><div class="ttdef"><b>Definition</b> PathSpaceBase.hpp:51</div></div>
<div class="ttc" id="aclass_s_p_1_1_path_space_base_html_a9d6d6181387a09664b3608813c29f51a"><div class="ttname"><a href="class_s_p_1_1_path_space_base.html#a9d6d6181387a09664b3608813c29f51a">SP::PathSpaceBase::take</a></div><div class="ttdeci">auto take(S const &amp;pathIn, Out const &amp;options={}) -&gt; Expected&lt; DataType &gt;</div><div class="ttdef"><b>Definition</b> PathSpaceBase.hpp:132</div></div>
<div class="ttc" id="aclass_s_p_1_1_path_space_html"><div class="ttname"><a href="class_s_p_1_1_path_space.html">SP::PathSpace</a></div><div class="ttdef"><b>Definition</b> PathSpace.hpp:23</div></div>
<div class="ttc" id="anamespace_s_p_html"><div class="ttname"><a href="namespace_s_p.html">SP</a></div><div class="ttdef"><b>Definition</b> AppPaths.cpp:40</div></div>
</div><!-- fragment --><p>Blocking read with timeout: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"><span class="keyword">using namespace </span>std::chrono_literals;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Times out because nothing is present at the path</span></div>
<div class="line">    <span class="keyword">auto</span> v = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/missing/value&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{100ms});</div>
<div class="line">    <span class="keywordflow">if</span> (!v) {</div>
<div class="line">        <span class="comment">// Timed out or not found</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Insert later from another thread, then read with a larger timeout</span></div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/ready/value&quot;</span>&gt;(7);</div>
<div class="line">    <span class="keyword">auto</span> r = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/ready/value&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{500ms}); <span class="comment">// returns 7</span></div>
<div class="line">}</div>
<div class="ttc" id="astruct_s_p_1_1_block_html"><div class="ttname"><a href="struct_s_p_1_1_block.html">SP::Block</a></div><div class="ttdef"><b>Definition</b> Out.hpp:29</div></div>
</div><!-- fragment --><p>Globbed insert (fan-out to existing matches): </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/sensors/a&quot;</span>&gt;(0);</div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/sensors/b&quot;</span>&gt;(0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Fan-out to existing children under /sensors/*</span></div>
<div class="line">    <span class="comment">// This will write the value 1 into all concrete children that exist.</span></div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/sensors/*&quot;</span>&gt;(1);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> a0 = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a9d6d6181387a09664b3608813c29f51a">take</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/sensors/a&quot;</span>); <span class="comment">// 0</span></div>
<div class="line">    <span class="keyword">auto</span> a1 = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/sensors/a&quot;</span>); <span class="comment">// 1</span></div>
<div class="line">    <span class="keyword">auto</span> b0 = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a9d6d6181387a09664b3608813c29f51a">take</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/sensors/b&quot;</span>); <span class="comment">// 0</span></div>
<div class="line">    <span class="keyword">auto</span> b1 = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/sensors/b&quot;</span>); <span class="comment">// 1</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Executions (lambdas, std::function, function pointers)</h1>
<p>Insert computations that produce values. Read triggers evaluation (Lazy) or retrieves the already-running (Immediate) result.</p>
<p>Lazy execution (runs on first read): </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/compute/lazy&quot;</span>&gt;([]() -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 100; }, <a class="code hl_struct" href="struct_s_p_1_1_lazy.html">Lazy</a>{});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Triggers the lambda to run, then copies the result</span></div>
<div class="line">    <span class="keyword">auto</span> v = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/compute/lazy&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{});</div>
<div class="line">    <span class="comment">// v.value() == 100</span></div>
<div class="line">}</div>
<div class="ttc" id="astruct_s_p_1_1_lazy_html"><div class="ttname"><a href="struct_s_p_1_1_lazy.html">SP::Lazy</a></div><div class="ttdef"><b>Definition</b> In.hpp:32</div></div>
</div><!-- fragment --><p>Immediate execution (scheduled at insert time): </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/compute/imm&quot;</span>&gt;([]() -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 1 + 1; }, <a class="code hl_struct" href="struct_s_p_1_1_immediate.html">Immediate</a>{});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The computation likely finished already; read returns the result.</span></div>
<div class="line">    <span class="keyword">auto</span> v = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/compute/imm&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{});</div>
<div class="line">    <span class="comment">// v.value() == 2</span></div>
<div class="line">}</div>
<div class="ttc" id="astruct_s_p_1_1_immediate_html"><div class="ttname"><a href="struct_s_p_1_1_immediate.html">SP::Immediate</a></div><div class="ttdef"><b>Definition</b> In.hpp:22</div></div>
</div><!-- fragment --><p>Chained computations: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// f3 produces 100</span></div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/f3&quot;</span>&gt;([]{ <span class="keywordflow">return</span> 100; });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// f2 reads f3 and returns +10</span></div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/f2&quot;</span>&gt;([&amp;]{</div>
<div class="line">        <span class="keywordflow">return</span> ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/f3&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{}).value() + 10;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// f1 reads f2 and returns +1</span></div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/f1&quot;</span>&gt;([&amp;]{</div>
<div class="line">        <span class="keywordflow">return</span> ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/f2&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{}).value() + 1;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> v = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;/f1&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{});</div>
<div class="line">    <span class="comment">// v.value() == 111</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>Advanced: peek the future for an execution result </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/exec&quot;</span>&gt;([]{ <span class="keywordflow">return</span> 42; }, <a class="code hl_struct" href="struct_s_p_1_1_immediate.html">Immediate</a>{});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Non-blocking peek via unified read; returns Expected&lt;FutureAny&gt;</span></div>
<div class="line">    <span class="keyword">auto</span> futExp = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<a class="code hl_class" href="class_s_p_1_1_future_any.html">FutureAny</a>&gt;(<span class="stringliteral">&quot;/exec&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (futExp) {</div>
<div class="line">        <span class="keyword">auto</span> fut = futExp.value();</div>
<div class="line">        <span class="comment">// Wait and copy typed result (caller must know the type)</span></div>
<div class="line">        <span class="keywordtype">int</span> out = 0;</div>
<div class="line">        fut.copy_to(&amp;out);</div>
<div class="line">        <span class="comment">// out == 42</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_s_p_1_1_future_any_html"><div class="ttname"><a href="class_s_p_1_1_future_any.html">SP::FutureAny</a></div><div class="ttdef"><b>Definition</b> IFutureAny.hpp:130</div></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
Data types and serialization</h1>
<ul>
<li>Fundamental types (int, double, etc.) are serialized directly</li>
<li>std::string and many STL containers and user-defined structs are serialized via Alpaca (see src/pathspace/type/serialization.hpp)</li>
<li>For custom structs, Alpaca can usually serialize them by value; see Alpaca's docs for constraints and attributes</li>
<li>Executions (functions/lambdas) are not serialized; they’re run within the process and their results are stored/served</li>
</ul>
<p>If you need to take results repeatedly, prefer read (copy) over take (pop). Use take to consume streams or queues where you only want the front element once.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Threading model</h1>
<ul>
<li>Reads/writes are thread-safe</li>
<li>Blocking reads use a wait/notify mechanism; you can pass timeouts with <span class="tt">Block{...}</span></li>
<li>Immediate executions are scheduled on the internal TaskPool when inserted</li>
<li>Lazy executions are scheduled on first read</li>
</ul>
<p>Tip: For high-throughput patterns, write with Immediate and read&lt;FutureAny&gt; to coordinate downstream consumers.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md16"></a>
Experimental IO providers (PathIO)</h1>
<p>The repository includes experimental providers under <span class="tt">src/pathspace/layer/io</span> and examples in <span class="tt">examples/devices_example.cpp</span> and <span class="tt">examples/paint_example.cpp</span>. These mount path-agnostic IO providers (e.g., mouse, keyboard) into a <span class="tt">PathSpace</span> tree and serve typed event streams using the canonical <span class="tt">/system/devices/in/*</span> namespace; see <span class="tt">docs/Plan_SceneGraph_Renderer.md</span> for app/device path conventions. The paint example combines those providers with the software renderer to offer a minimal mouse-driven canvas.</p>
<p>Sketch: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_space_8hpp.html">pathspace/PathSpace.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_i_o_mouse_8hpp.html">pathspace/layer/io/PathIOMouse.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_path_i_o_keyboard_8hpp.html">pathspace/layer/io/PathIOKeyboard.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_s_p.html">SP</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="class_s_p_1_1_path_space.html">PathSpace</a> ps;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> mouse    = std::make_unique&lt;PathIOMouse&gt;(<a class="code hl_enumvalue" href="class_s_p_1_1_path_i_o_mouse.html#abe2878f95ed3de9d9b3aed169d260a62a06b9281e396db002010bde1de57262eb">PathIOMouse::BackendMode::Auto</a>);</div>
<div class="line">    <span class="keyword">auto</span> keyboard = std::make_unique&lt;PathIOKeyboard&gt;(<a class="code hl_enumvalue" href="class_s_p_1_1_path_i_o_keyboard.html#aa4d8386b1b19a9c5db38382e4bed929ea06b9281e396db002010bde1de57262eb">PathIOKeyboard::BackendMode::Auto</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Mount providers at app-chosen paths</span></div>
<div class="line">    <span class="keyword">auto</span> mret = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/system/devices/in/pointer/default&quot;</span>&gt;(std::move(mouse));</div>
<div class="line">    <span class="keyword">auto</span> kret = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a7f160bb41b90202c97f3581612e22001">insert</a>&lt;<span class="stringliteral">&quot;/system/devices/in/text/default&quot;</span>&gt;(std::move(keyboard));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read typed events (blocking with timeout)</span></div>
<div class="line">    <span class="keyword">auto</span> me = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<a class="code hl_typedef" href="class_s_p_1_1_path_i_o_mouse.html#aa67fd5094d11dd5dbc15e6198019b73e">SP::PathIOMouse::Event</a>&gt;(<span class="stringliteral">&quot;/system/devices/in/pointer/default/events&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{});</div>
<div class="line">    <span class="keyword">auto</span> ke = ps.<a class="code hl_function" href="class_s_p_1_1_path_space_base.html#a2941f2763aad2813c12a9a886ccf5961">read</a>&lt;<a class="code hl_typedef" href="class_s_p_1_1_path_i_o_keyboard.html#ac3900d2803758ffc2d76a74a82af9bc8">SP::PathIOKeyboard::Event</a>&gt;(<span class="stringliteral">&quot;/system/devices/in/text/default/events&quot;</span>, <a class="code hl_struct" href="struct_s_p_1_1_block.html">Block</a>{});</div>
<div class="line">}</div>
<div class="ttc" id="a_path_i_o_keyboard_8hpp_html"><div class="ttname"><a href="_path_i_o_keyboard_8hpp.html">PathIOKeyboard.hpp</a></div></div>
<div class="ttc" id="a_path_i_o_mouse_8hpp_html"><div class="ttname"><a href="_path_i_o_mouse_8hpp.html">PathIOMouse.hpp</a></div></div>
<div class="ttc" id="aclass_s_p_1_1_path_i_o_keyboard_html_aa4d8386b1b19a9c5db38382e4bed929ea06b9281e396db002010bde1de57262eb"><div class="ttname"><a href="class_s_p_1_1_path_i_o_keyboard.html#aa4d8386b1b19a9c5db38382e4bed929ea06b9281e396db002010bde1de57262eb">SP::PathIOKeyboard::BackendMode::Auto</a></div><div class="ttdeci">@ Auto</div><div class="ttdef"><b>Definition</b> PathIOKeyboard.hpp:80</div></div>
<div class="ttc" id="aclass_s_p_1_1_path_i_o_keyboard_html_ac3900d2803758ffc2d76a74a82af9bc8"><div class="ttname"><a href="class_s_p_1_1_path_i_o_keyboard.html#ac3900d2803758ffc2d76a74a82af9bc8">SP::PathIOKeyboard::Event</a></div><div class="ttdeci">KeyboardEvent Event</div><div class="ttdef"><b>Definition</b> PathIOKeyboard.hpp:78</div></div>
<div class="ttc" id="aclass_s_p_1_1_path_i_o_mouse_html_aa67fd5094d11dd5dbc15e6198019b73e"><div class="ttname"><a href="class_s_p_1_1_path_i_o_mouse.html#aa67fd5094d11dd5dbc15e6198019b73e">SP::PathIOMouse::Event</a></div><div class="ttdeci">MouseEvent Event</div><div class="ttdef"><b>Definition</b> PathIOMouse.hpp:87</div></div>
<div class="ttc" id="aclass_s_p_1_1_path_i_o_mouse_html_abe2878f95ed3de9d9b3aed169d260a62a06b9281e396db002010bde1de57262eb"><div class="ttname"><a href="class_s_p_1_1_path_i_o_mouse.html#abe2878f95ed3de9d9b3aed169d260a62a06b9281e396db002010bde1de57262eb">SP::PathIOMouse::BackendMode::Auto</a></div><div class="ttdeci">@ Auto</div><div class="ttdef"><b>Definition</b> PathIOMouse.hpp:89</div></div>
</div><!-- fragment --><p>Notes:</p><ul>
<li>These providers are evolving; platform-specific backends may require flags (ENABLE_PATHIO_MACOS)</li>
<li>The example simulates events if no OS backend is active</li>
</ul>
<p>See:</p><ul>
<li>examples/devices_example.cpp</li>
<li>src/pathspace/layer/io/*</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md17"></a>
CMake integration</h1>
<p>As a subproject: </p><div class="fragment"><div class="line"># In your CMakeLists.txt</div>
<div class="line">add_subdirectory(PathSpace)</div>
<div class="line">target_link_libraries(your_app PRIVATE PathSpace)</div>
<div class="line">target_include_directories(your_app PRIVATE ${CMAKE_SOURCE_DIR}/PathSpace/src) # if needed</div>
</div><!-- fragment --><p>As an installed library: </p><div class="fragment"><div class="line">find_package(PathSpace REQUIRED) # if you export a config in your environment</div>
<div class="line">target_link_libraries(your_app PRIVATE PathSpace)</div>
</div><!-- fragment --><p>Options:</p><ul>
<li>ENABLE_ADDRESS_SANITIZER, ENABLE_THREAD_SANITIZER, ENABLE_UNDEFINED_SANITIZER (default OFF)</li>
<li>ENABLE_PATHIO_MACOS (default OFF)</li>
<li>BUILD_PATHSPACE_EXAMPLES (default OFF)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md18"></a>
Troubleshooting</h1>
<ul>
<li>Path must be concrete for read/take; insert can use globs to target existing matches</li>
<li>Use <span class="tt">Block{...}</span> for blocking reads; without it, reads are non-blocking and may return NoObjectFound</li>
<li>When using Immediate executions, ensure you are reading the correct type at the path</li>
<li>For timeouts or readiness issues, <span class="tt">readFuture</span> lets you explicitly coordinate on completion</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md19"></a>
License</h1>
<p>See LICENSE for details.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
Contributing</h1>
<ul>
<li>Keep docs and code consistent; if you change core behavior or APIs (paths, NodeData, WaitMap, TaskPool, serialization), update docs/AI_Architecture.md</li>
<li>Run tests: <span class="tt">./scripts/compile.sh &amp;&amp; ctest --test-dir build -j</span></li>
<li>PRs should include a short “Purpose” and an “AI Change Log” when applicable </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
